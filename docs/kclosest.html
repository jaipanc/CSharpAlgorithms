<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#57B747"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2026-02-07T22:58:27.2410349"><title>658.Find K Closest Elements | DSA using C#.NET</title><script type="application/json" id="virtual-toc-data">[{"id":"core-trick-best-approach","level":0,"title":"Core trick (best approach)","anchor":"#core-trick-best-approach"},{"id":"step-by-step-example-c-style-walkthrough","level":0,"title":"Step-by-step example (C# style walkthrough)","anchor":"#step-by-step-example-c-style-walkthrough"},{"id":"c-solution-binary-search-on-window-start","level":0,"title":"C# Solution (Binary Search on Window Start)","anchor":"#c-solution-binary-search-on-window-start"},{"id":"complexity","level":0,"title":"Complexity","anchor":"#complexity"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.25.3-b857/app.css" rel="stylesheet"><link rel="icon" type="image/png" sizes="16x16" href="https://www.python.org/static/apple-touch-icon-144x144-precomposed.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="658.Find K Closest Elements | DSA using C#.NET"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="DSA using C#.NET Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/https://github.com/jaipanc/CSharpAlgorithms/tree/master/docs/kclosest.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="658.Find K Closest Elements | DSA using C#.NET"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/https://github.com/jaipanc/CSharpAlgorithms/tree/master/docs/kclosest.html#webpage",
    "url": "writerside-documentation/https://github.com/jaipanc/CSharpAlgorithms/tree/master/docs/kclosest.html",
    "name": "658.Find K Closest Elements | DSA using C#.NET",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentationhttps://github.com/jaipanc/CSharpAlgorithms/tree/master/docs/#website",
    "url": "writerside-documentationhttps://github.com/jaipanc/CSharpAlgorithms/tree/master/docs/",
    "name": "DSA using C#.NET Help"
}</script><!-- End Schema.org --></head><body data-id="KClosest" data-main-title="658.Find K Closest Elements" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="üóÉÔ∏è-Heap-PriorityQueue.md|üóÉÔ∏è Heap / PriorityQueue"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>DSA using C#.NET  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="KClosest" id="KClosest.md">658.Find K Closest Elements</h1><p id="-xrbrut_3"><code class="code" id="-xrbrut_10">Find K Closest Elements</code> (LeetCode 658) usually means:</p><aside class="prompt" data-type="tip" data-title="" id="-xrbrut_4"><p id="-xrbrut_11">Given a <span class="control" id="-xrbrut_12">sorted</span> array <code class="code" id="-xrbrut_13">arr</code>, find the <span class="control" id="-xrbrut_14">k</span> elements closest to <code class="code" id="-xrbrut_15">x</code>. Return them in <span class="control" id="-xrbrut_16">ascending order</span>. If tie (same distance), prefer the <span class="control" id="-xrbrut_17">smaller</span> element.</p></aside><section class="chapter"><h2 id="core-trick-best-approach" data-toc="core-trick-best-approach">Core trick (best approach)</h2><p id="-xrbrut_18">Because <code class="code" id="-xrbrut_21">arr</code> is sorted, the answer is always a <span class="control" id="-xrbrut_22">contiguous window of length k</span>.</p><p id="-xrbrut_19">So we just need to find the best <span class="control" id="-xrbrut_23">left index</span> of that window.</p><section class="chapter"><h3 id="window-comparison-rule" data-toc="window-comparison-rule">Window comparison rule</h3><p id="-xrbrut_24">For a candidate window starting at <code class="code" id="-xrbrut_30">mid</code>:</p><ul class="list _bullet" id="-xrbrut_25"><li class="list__item" id="-xrbrut_31"><p id="-xrbrut_33">left edge = <code class="code" id="-xrbrut_34">arr[mid]</code></p></li><li class="list__item" id="-xrbrut_32"><p id="-xrbrut_35">right edge just outside window = <code class="code" id="-xrbrut_36">arr[mid + k]</code></p></li></ul><p id="-xrbrut_26">We decide whether to move left or right using:</p><p id="-xrbrut_27">If <code class="code" id="-xrbrut_37">x - arr[mid] &gt; arr[mid + k] - x</code> &rarr; left edge is farther than the right-outside edge &rarr; shift window right &rarr; <code class="code" id="-xrbrut_38">left = mid + 1</code> Else &rarr; shift window left (or stay) &rarr; <code class="code" id="-xrbrut_39">right = mid</code></p><p id="-xrbrut_28">This is a binary search on the <span class="control" id="-xrbrut_40">window start</span>.</p></section></section><section class="chapter"><h2 id="step-by-step-example-c-style-walkthrough" data-toc="step-by-step-example-c-style-walkthrough">Step-by-step example (C# style walkthrough)</h2><section class="chapter"><h3 id="example" data-toc="example">Example</h3><p id="-xrbrut_43"><code class="code" id="-xrbrut_48">arr = [1,2,3,4,5]</code>, <code class="code" id="-xrbrut_49">k = 4</code>, <code class="code" id="-xrbrut_50">x = 3</code></p><p id="-xrbrut_44">We search left index between:</p><ul class="list _bullet" id="-xrbrut_45"><li class="list__item" id="-xrbrut_51"><p id="-xrbrut_53"><code class="code" id="-xrbrut_54">left = 0</code></p></li><li class="list__item" id="-xrbrut_52"><p id="-xrbrut_55"><code class="code" id="-xrbrut_56">right = n - k = 5 - 4 = 1</code></p></li></ul><p id="-xrbrut_46">So left can only be <code class="code" id="-xrbrut_57">0</code> or <code class="code" id="-xrbrut_58">1</code>.</p><section class="chapter"><h4 id="iteration1" data-toc="iteration1">Iteration1</h4><ul class="list _bullet" id="-xrbrut_59"><li class="list__item" id="-xrbrut_67"><p id="-xrbrut_69"><code class="code" id="-xrbrut_70">left = 0</code>, <code class="code" id="-xrbrut_71">right = 1</code></p></li><li class="list__item" id="-xrbrut_68"><p id="-xrbrut_72"><code class="code" id="-xrbrut_73">mid = (0 + 1) / 2 = 0</code></p></li></ul><p id="-xrbrut_60">Compare:</p><ul class="list _bullet" id="-xrbrut_61"><li class="list__item" id="-xrbrut_74"><p id="-xrbrut_76"><code class="code" id="-xrbrut_77">x - arr[mid] = 3 - arr[0] = 3 - 1 = 2</code></p></li><li class="list__item" id="-xrbrut_75"><p id="-xrbrut_78"><code class="code" id="-xrbrut_79">arr[mid + k] - x = arr[0 + 4] - 3 = arr[4] - 3 = 5 - 3 = 2</code></p></li></ul><p id="-xrbrut_62">Check:</p><ul class="list _bullet" id="-xrbrut_63"><li class="list__item" id="-xrbrut_80"><p id="-xrbrut_81"><code class="code" id="-xrbrut_82">2 &gt; 2</code>? ‚ùå No So <code class="code" id="-xrbrut_83">right = mid = 0</code></p></li></ul><p id="-xrbrut_64">Loop ends (<code class="code" id="-xrbrut_84">left == right == 0</code>)</p><p id="-xrbrut_65">‚úÖ Best window starts at index <code class="code" id="-xrbrut_85">0</code> Take <code class="code" id="-xrbrut_86">k=4</code> elements: <code class="code" id="-xrbrut_87">[1,2,3,4]</code></p></section></section><section class="chapter"><h3 id="another-example-with-movement" data-toc="another-example-with-movement">Another example with movement</h3><p id="-xrbrut_88"><code class="code" id="-xrbrut_92">arr = [1,2,3,4,5,6,7]</code>, <code class="code" id="-xrbrut_93">k = 3</code>, <code class="code" id="-xrbrut_94">x = 5</code></p><ul class="list _bullet" id="-xrbrut_89"><li class="list__item" id="-xrbrut_95"><p id="-xrbrut_97"><code class="code" id="-xrbrut_98">n=7</code>, <code class="code" id="-xrbrut_99">right = n-k = 4</code></p></li><li class="list__item" id="-xrbrut_96"><p id="-xrbrut_100">start range: <code class="code" id="-xrbrut_101">left=0</code>, <code class="code" id="-xrbrut_102">right=4</code></p></li></ul><section class="chapter"><h4 id="iteration-1" data-toc="iteration-1">Iteration 1</h4><ul class="list _bullet" id="-xrbrut_103"><li class="list__item" id="-xrbrut_104"><p id="-xrbrut_107"><code class="code" id="-xrbrut_108">mid = (0+4)/2 = 2</code> Window would be <code class="code" id="-xrbrut_109">[arr[2],arr[3],arr[4]] = [3,4,5]</code> Compare:</p></li><li class="list__item" id="-xrbrut_105"><p id="-xrbrut_110"><code class="code" id="-xrbrut_111">x - arr[mid] = 5 - 3 = 2</code></p></li><li class="list__item" id="-xrbrut_106"><p id="-xrbrut_112"><code class="code" id="-xrbrut_113">arr[mid+k] - x = arr[5] - 5 = 6 - 5 = 1</code> <code class="code" id="-xrbrut_114">2 &gt; 1</code> ‚úÖ &rarr; shift right <code class="code" id="-xrbrut_115">left = mid + 1 = 3</code></p></li></ul></section><section class="chapter"><h4 id="iteration-2" data-toc="iteration-2">Iteration 2</h4><ul class="list _bullet" id="-xrbrut_116"><li class="list__item" id="-xrbrut_119"><p id="-xrbrut_123"><code class="code" id="-xrbrut_124">left=3</code>, <code class="code" id="-xrbrut_125">right=4</code></p></li><li class="list__item" id="-xrbrut_120"><p id="-xrbrut_126"><code class="code" id="-xrbrut_127">mid = (3+4)/2 = 3</code> Window <code class="code" id="-xrbrut_128">[4,5,6]</code> Compare:</p></li><li class="list__item" id="-xrbrut_121"><p id="-xrbrut_129"><code class="code" id="-xrbrut_130">x - arr[3] = 5 - 4 = 1</code></p></li><li class="list__item" id="-xrbrut_122"><p id="-xrbrut_131"><code class="code" id="-xrbrut_132">arr[6] - 5 = 7 - 5 = 2</code> <code class="code" id="-xrbrut_133">1 &gt; 2</code> ‚ùå &rarr; shift left/stay <code class="code" id="-xrbrut_134">right = mid = 3</code></p></li></ul><p id="-xrbrut_117">End: <code class="code" id="-xrbrut_135">left=3</code> ‚úÖ Answer window = indices <code class="code" id="-xrbrut_136">3..5</code> &rarr; <code class="code" id="-xrbrut_137">[4,5,6]</code></p></section></section></section><section class="chapter"><h2 id="c-solution-binary-search-on-window-start" data-toc="c-solution-binary-search-on-window-start">C# Solution (Binary Search on Window Start)</h2><div class="code-block" data-lang="csharp">
using System;
using System.Collections.Generic;

public class Solution
{
    public IList&lt;int&gt; FindClosestElements(int[] arr, int k, int x)
    {
        int n = arr.Length;
        int left = 0;
        int right = n - k; // last possible start index of a k-window

        while (left &lt; right)
        {
            int mid = left + (right - left) / 2;

            // Compare distances between arr[mid] and arr[mid+k] relative to x
            int distLeft = x - arr[mid];
            int distRight = arr[mid + k] - x;

            if (distLeft &gt; distRight)
            {
                // left edge is farther -&gt; move window right
                left = mid + 1;
            }
            else
            {
                // window is good or should move left
                right = mid;
            }
        }

        // Build result from the best window
        var result = new List&lt;int&gt;(k);
        for (int i = left; i &lt; left + k; i++)
            result.Add(arr[i]);

        return result;
    }
}
</div></section><section class="chapter"><h2 id="complexity" data-toc="complexity">Complexity</h2><ul class="list _bullet" id="-xrbrut_140"><li class="list__item" id="-xrbrut_142"><p id="-xrbrut_144">Time: <span class="control" id="-xrbrut_145">O(log(n-k) + k)</span> (binary search + output k items)</p></li><li class="list__item" id="-xrbrut_143"><p id="-xrbrut_146">Space: <span class="control" id="-xrbrut_147">O(k)</span> for the output</p></li></ul></section><div class="last-modified">19 January 2026</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="215.html" class="navigation-links__prev">215.Kth Largest Element in an Array</a><a href="kclosetpoints.html" class="navigation-links__next">973.K Closet Points to Origin</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.25.3-b857/app.js"></script></body></html>